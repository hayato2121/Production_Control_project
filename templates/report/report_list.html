{% extends 'base.html' %}

{% block content %}
<h1>所属部署:{{ user.department.name }}</h1>

<!--作業一覧-->
{% if request.user.department.name == '出荷部' %}
    {% if shippings %}
        <p>出荷業務 (業務はこちらをお使いください)</p>
            <ul>
                <table>
                    <thead>
                        <tr>
                            <td>製品名</td>
                            <td>納品先</td>
                            <td>出荷日</td>
                            <td>出荷数</td>
                            <td>引き継ぎ</td>
                            <td>ステータス</td>
                        </tr>
                    </thead>
                    <tbody>
                        {% for shipping in shippings %}
                            <tr>
                                <td>{{ shipping.product }}</td>
                                <td>{{ shipping.delivery }}</td>
                                <td>{{ shipping.shipping_day }}</td>
                                <td>{{ shipping.shipments_required }}</td>
                                <td>{{ shipping.memo }}</td>
                                {% if shipping.stock1 or shipping.stock2 or shipping.stock3 %}
                                <td>終了</td>
                                {% else %}
                                <td>実行中</td>
                                {% endif %}
                                <td><button><a href="{% url 'daily_report:shipping_detail' pk=shipping.id %}">詳細画面</a></button></td>
                                <!--あとでcssを使ってモーダルウィンドウにする-->
                                <td><button><a href="{% url 'daily_report:shipping_delate' pk=shipping.id %}">削除</a></button></td>
                            </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </ul>
    {% endif %}
    {% if reports %}
        <P>出荷日報(出荷業務を元に自動作成)</P>
        <ul>
            <table >
                <thead>
                    <tr>
                        <td>製品名</td>
                        <td>製品コード</td>
                        <td>業務内容</td>
                        <td>作業者</td>
                        <td>ロッド番号</td>
                        <td>作業状況</td>
                        <td>優良成形数</td>
                        <td>不良成形数</td>
                    </tr>
                </thead>
                <tbody>
                    {% for report in reports %}
                    <tr>
                        <td>{{ report.product.name }}</td>
                        <td>{{ report.product.code }}</td>
                        <td>{{ report.business.name }}</td>
                        <td>{{ report.user.username }}</td>
                        <td>{{ report.lot_number }}</td>
                        <td>{{ report.status }}</td>

                        {% if report.good_product is not None %}
                        <td>{{ report.good_product }}</td>
                        <td>{{ report.bad_product }}</td>
                        {% endif %}
                        <!--あとでcssを使ってモーダルウィンドウにする-->
                        <td><button><a href="{% url 'daily_report:report_delete' pk=report.id %}">削除</a></button></td>
                        
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </ul>
        <p><a href="{% url 'daily_report:stock_list' %}">在庫を修正する</a></p>
    {% endif %}
{% else %}
    {% if reports %}
    <ul>
        <table >
            <thead>
                <tr>
                    <td>製品名</td>
                    <td>製品コード</td>
                    <td>業務内容</td>
                    <td>作業者</td>
                    <td>ロッド番号</td>
                    <td>作業状況</td>
                    <td>優良成形数</td>
                    <td>不良成形数</td>
                </tr>
            </thead>
            <tbody>
                {% for report in reports %}
                <tr>
                    <td>{{ report.product.name }}</td>
                    <td>{{ report.product.code }}</td>
                    <td>{{ report.business.name }}</td>
                    <td>{{ report.user.username }}</td>
                    <td>{{ report.lot_number }}</td>
                    <td>{{ report.status }}</td>

                    {% if report.good_product is not None %}
                    <td>{{ report.good_product }}</td>
                    <td>{{ report.bad_product }}</td>
                    {% endif %}

                    <td><button><a href="{% url 'daily_report:report_detail' pk=report.id %}">詳細画面</a></button></td>
                    <!--あとでcssを使ってモーダルウィンドウにする-->
                    <td><button><a href="{% url 'daily_report:report_delete' pk=report.id %}">削除</a></button></td>
                    
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </ul>
    {% endif %}
{% endif %}


{% if request.user.department.name == '製造部' %}
    <button><a href="{% url 'daily_report:report_start' %}">作業をスタートする</a></button>
    {% elif request.user.department.name == '検査部' %}
    <button><a href="{% url 'daily_report:report_start_inspection' %}">作業をスタートする_検査</a></button>
    {% elif request.user.department.name == '出荷部' %}
    <button><a href="{% url 'daily_report:shipping_start'%}">作業をスタートする_出荷</a></button>
    {% else %}
    <button><a href="{% url 'daily_report:report_start' %}">作業をスタートする</a></button>
{% endif %}

<p><a href="{% url 'daily_report:logout' %}">本日の作業を終了する</a></p>

{% endblock %}

